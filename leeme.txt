================================================================================
                    Proyecto EmoLyrics IAO - Grupo 6
================================================================================
Nombres: LucÃ­a Bachiller, Vicente Barbato, Juan MacÃ­as

DESCRIPCIÃ“N DEL PROYECTO
--------------------------------------------------------------------------------
Este proyecto implementa un sistema de anÃ¡lisis emocional de letras de canciones
utilizando modelos de aprendizaje profundo. Incluye una aplicaciÃ³n web interactiva
construida con Streamlit que permite analizar letras y comparar diferentes versiones
de las mismas para evaluar su perfil emocional.

ESTRUCTURA DE CARPETAS Y ARCHIVOS
--------------------------------------------------------------------------------

ğŸ“ RaÃ­z del proyecto
   â”œâ”€â”€ app.py
   â”‚   â””â”€â”€ Punto de entrada principal de la aplicaciÃ³n Streamlit. Configura la
   â”‚       pÃ¡gina y gestiona las pestaÃ±as de anÃ¡lisis y comparaciÃ³n.
   â”‚
   â”œâ”€â”€ emo_core.py
   â”‚   â””â”€â”€ MÃ³dulo central que contiene la lÃ³gica de negocio: generaciÃ³n de scores
   â”‚       emocionales, renderizado de grÃ¡ficos (Altair), gestiÃ³n del estado de
   â”‚       sesiÃ³n, y carga de plantillas HTML/CSS.
   â”‚
   â”œâ”€â”€ README.md
   â”‚   â””â”€â”€ DocumentaciÃ³n bÃ¡sica del proyecto con instrucciones de instalaciÃ³n.
   â”‚
   â”œâ”€â”€ analysis.md
   â”‚   â””â”€â”€ Notas y resultados de anÃ¡lisis del dataset durante la limpieza.
   â”‚
   â”œâ”€â”€ environment.yml
   â”‚   â””â”€â”€ Archivo de configuraciÃ³n de Conda que define el entorno virtual
   â”‚       con todas las dependencias y versiones exactas del proyecto.
   â”‚       Permite recrear el entorno con: conda env create -f environment.yml
   â”‚
   â””â”€â”€ .gitignore
       â””â”€â”€ Archivo de configuraciÃ³n de Git para excluir archivos del control
           de versiones (__pycache__, modelos, etc.).

ğŸ“ data/
   â”œâ”€â”€ spotify_dataset.csv
   â”‚   â””â”€â”€ Dataset original de Spotify con 500K+ canciones, letras y emociones.
   â”‚       Fuente: Kaggle (900k Spotify Songs with Lyrics, Emotions & More).
   â”‚
   â””â”€â”€ spotify_emotion_clean.csv
       â””â”€â”€ Dataset limpio generado por clean-emotion.py. Contiene letras
           normalizadas y etiquetas emocionales validadas.

ğŸ“ scripts/
   â”œâ”€â”€ clean-emotion.py
   â”‚   â””â”€â”€ Script de limpieza y preprocesamiento del dataset. Realiza:
   â”‚       - NormalizaciÃ³n de etiquetas emocionales
   â”‚       - EliminaciÃ³n de letras vacÃ­as o duplicadas
   â”‚       - Filtrado por longitud de texto (30-10000 caracteres)
   â”‚       - EliminaciÃ³n de clases raras (<5000 muestras)
   â”‚       - Genera visualizaciones de distribuciÃ³n de emociones
   â”‚
   â”œâ”€â”€ clean-good4.py
   â”‚   â””â”€â”€ Script alternativo de limpieza para etiquetas "Good for" (Party,
   â”‚       Work/Study, Exercise, etc.). Filtra y normaliza el dataset original.
   â”‚
   â””â”€â”€ visualize-good4.py
       â””â”€â”€ Script de visualizaciÃ³n que genera grÃ¡ficos de barras para:
           - DistribuciÃ³n de etiquetas "Good for"
           - Top 50 artistas por nÃºmero de canciones
           - Top 30 gÃ©neros musicales

ğŸ“ interface/
   â”œâ”€â”€ ui.py
   â”‚   â””â”€â”€ MÃ³dulo de interfaz de usuario que implementa las dos pestaÃ±as
   â”‚       principales: "Analyze your lyrics" y "Compare versions of lyrics".
   â”‚       Gestiona la entrada de texto, anÃ¡lisis y guardado de versiones.
   â”‚
   â”œâ”€â”€ styles.css
   â”‚   â””â”€â”€ Hoja de estilos CSS personalizada para la aplicaciÃ³n Streamlit.
   â”‚       Define el diseÃ±o visual, colores, tipografÃ­a (Inter) y componentes
   â”‚       personalizados (tarjetas, badges, etc.).
   â”‚
   â””â”€â”€ templates.html
       â””â”€â”€ Plantillas HTML reutilizables para el header de la aplicaciÃ³n y
           las tarjetas de resultados emocionales.

ğŸ“ training/
   â”œâ”€â”€ emotion-classification-lyrics.ipynb
   â”‚   â””â”€â”€ Notebook Jupyter con el pipeline completo de entrenamiento:
   â”‚       - Carga y preprocesamiento de datos
   â”‚       - GeneraciÃ³n de embeddings con SentenceTransformers
   â”‚       - Entrenamiento de redes neuronales (LinearReLUDropoutLinearNet)
   â”‚       - EvaluaciÃ³n y guardado de modelos
   â”‚
   â”œâ”€â”€ test_inference.py
   â”‚   â””â”€â”€ Script de prueba para cargar modelos entrenados y realizar
   â”‚       inferencias sobre texto de ejemplo. Incluye la clase del modelo
   â”‚       y funciones de carga/predicciÃ³n.
   â”‚
   â””â”€â”€ models/
       â”œâ”€â”€ emotion_classifier_v2.pt
       â”‚   â””â”€â”€ Modelo principal entrenado (checkpoint de PyTorch).
       â”‚
       â”œâ”€â”€ emotion_classifier_all-MiniLM-L6-v2.pt
       â”œâ”€â”€ emotion_classifier_all-MiniLM-L12-v2.pt
       â”œâ”€â”€ emotion_classifier_all-distilroberta-v1.pt
       â”œâ”€â”€ emotion_classifier_all-mpnet-base-v2.pt
       â”‚   â””â”€â”€ Modelos alternativos entrenados con diferentes backbones de
       â”‚       SentenceTransformers.
       â”‚
       â””â”€â”€ scaler.joblib
           â””â”€â”€ Escalador StandardScaler guardado para normalizar embeddings
               antes de la inferencia (si se utilizÃ³ durante el entrenamiento).

ğŸ“ __pycache__/
   â””â”€â”€ Directorio generado automÃ¡ticamente por Python con archivos .pyc
       compilados (no incluido en el .zip, generado en ejecuciÃ³n).

INSTRUCCIONES BÃSICAS PARA EJECUTAR LOS EXPERIMENTOS
--------------------------------------------------------------------------------

1. PREPARACIÃ“N DEL ENTORNO
   -----------------------
   a) Crear entorno conda desde environment.yml (recomendado):
      conda env create -f environment.yml
      conda activate iao

   b) O instalar dependencias manualmente con pip:
      pip install streamlit altair pandas matplotlib torch sentence-transformers
      scikit-learn joblib numpy

2. PREPARACIÃ“N DE DATOS
   --------------------
   a) Colocar el archivo spotify_dataset.csv en la carpeta data/
      (descargar desde Kaggle: https://www.kaggle.com/datasets/devdope/900k-spotify/data)

   b) Ejecutar el script de limpieza:
      cd scripts
      python clean-emotion.py
      
      Esto generarÃ¡ data/spotify_emotion_clean.csv

   c) (Opcional) Para visualizar distribuciones:
      python visualize-good4.py

3. ENTRENAMIENTO DEL MODELO
   -------------------------
   a) Abrir el notebook Jupyter:
      cd training
      jupyter notebook emotion-classification-lyrics.ipynb

   b) Ejecutar todas las celdas del notebook. El proceso incluye:
      - Carga del dataset limpio
      - GeneraciÃ³n de embeddings con SentenceTransformer
      - Entrenamiento de la red neuronal con validaciÃ³n cruzada
      - Entrenamiento final del modelo usando el total del split de entrenamiento y evaluando con el split de test
      - Guardado del modelo en training/models/

   c) (Opcional) Probar inferencia:
      python test_inference.py

4. EJECUTAR LA APLICACIÃ“N WEB
   ---------------------------
   a) Desde la raÃ­z del proyecto:
      streamlit run app.py

   b) La aplicaciÃ³n se abrirÃ¡ automÃ¡ticamente en el navegador en
      http://localhost:8501

   c) Funcionalidades disponibles:
      - PestaÃ±a "Analyze your lyrics": Introducir letras manualmente o
        subir un archivo .txt y obtener el perfil emocional.
      - PestaÃ±a "Compare versions": Comparar diferentes versiones de letras
        guardadas previamente.

SOFTWARE, LIBRERÃAS Y VERSIONES UTILIZADAS
--------------------------------------------------------------------------------

Lenguaje y versiÃ³n:
   - Python 3.9+ (probado con Python 3.9 y 3.10)

LibrerÃ­as principales:
   - streamlit >= 1.28.0
     â””â”€â”€ Framework para la aplicaciÃ³n web interactiva

   - pandas >= 1.5.0
     â””â”€â”€ ManipulaciÃ³n y anÃ¡lisis de datos

   - altair >= 5.0.0
     â””â”€â”€ VisualizaciÃ³n de grÃ¡ficos interactivos

   - torch >= 2.0.0
     â””â”€â”€ Framework de aprendizaje profundo (PyTorch)

   - sentence-transformers >= 2.2.0
     â””â”€â”€ Modelos pre-entrenados para embeddings de texto
         Modelos utilizados:
         - all-MiniLM-L6-v2 (384 dim)
         - all-MiniLM-L12-v2 (384 dim)
         - all-distilroberta-v1 (768 dim)
         - all-mpnet-base-v2 (768 dim)

   - scikit-learn >= 1.3.0
     â””â”€â”€ Preprocesamiento (StandardScaler) y mÃ©tricas de evaluaciÃ³n

   - joblib >= 1.3.0
     â””â”€â”€ SerializaciÃ³n de modelos y escaladores

   - numpy >= 1.24.0
     â””â”€â”€ Operaciones numÃ©ricas

   - matplotlib >= 3.7.0
     â””â”€â”€ Visualizaciones en scripts de anÃ¡lisis

Herramientas adicionales:
   - Jupyter Notebook / JupyterLab
     â””â”€â”€ Para ejecutar el notebook de entrenamiento

   - Conda / Miniconda (opcional pero recomendado)
     â””â”€â”€ GestiÃ³n de entornos virtuales

NOTAS RELEVANTES PARA LA CORRECTA REPRODUCCIÃ“N
--------------------------------------------------------------------------------

1. DATASET
   --------
   - El dataset original (spotify_dataset.csv) NO estÃ¡ incluido en el .zip debido
     a su tamaÃ±o. Debe descargarse desde Kaggle:
     https://www.kaggle.com/datasets/devdope/900k-spotify/data
     Seleccionar el archivo spotify_dataset.csv y colocarlo en data/

   - El dataset limpio (spotify_emotion_clean.csv) puede generarse ejecutando
     clean-emotion.py, o puede estar incluido si se proporciona pre-procesado.

2. MODELOS ENTRENADOS
   -------------------
   - Los modelos en training/models/ pueden tener un tamaÃ±o considerable
     (varios MB cada uno). Se crearÃ¡n una sola vez ejecutando el notebook emotion-classification-lyrics.ipynb.
     Si es necesario, se pueden volver a crear cambiando la variable RECOMPUTE_EMBEDDINGS a True.
    

   - El modelo principal utilizado es emotion_classifier_v2.pt. Si se desea usar
     otro modelo, modificar la ruta en test_inference.py o en emo_core.py
     (funciÃ³n generate_emotion_scores).

3. CONFIGURACIÃ“N DE RUTAS
   -----------------------
   - Los scripts asumen que se ejecutan desde la raÃ­z del proyecto o desde su
     directorio correspondiente (scripts/, training/).

   - Si se ejecuta desde otra ubicaciÃ³n, ajustar las rutas relativas en:
     * scripts/clean-emotion.py (INPUT_FILE, OUTPUT_FILE)
     * scripts/clean-good4.py (ruta al CSV)
     * training/test_inference.py (ruta al modelo)

4. FUNCIONALIDAD ACTUAL DEL MODELO
   ---------------------------------
   - NOTA IMPORTANTE: En emo_core.py, la funciÃ³n generate_emotion_scores()
     actualmente utiliza valores aleatorios como placeholder. Para usar el modelo
     real, debe integrarse la lÃ³gica de carga del modelo y predicciÃ³n similar a
     la implementada en training/test_inference.py.

   - Para integrar el modelo real:
     1. Cargar el modelo y SentenceTransformer al inicio de la sesiÃ³n
     2. Modificar generate_emotion_scores() para usar el modelo cargado
     3. Asegurar que el dispositivo (CPU/GPU) sea consistente

5. RECURSOS DEL SISTEMA
   --------------------
   - El entrenamiento del modelo requiere memoria RAM suficiente (recomendado 8GB+)
     y puede tardar varias horas dependiendo del hardware.

   - La generaciÃ³n de embeddings puede ser lenta en CPU. Se recomienda GPU
     (CUDA) si estÃ¡ disponible para acelerar el proceso.

6. EMOCIONES DETECTADAS
   --------------------
   El modelo clasifica 6 emociones principales:
   - Anger (Ira)
   - Fear (Miedo)
   - Joy (AlegrÃ­a)
   - Love (Amor)
   - Sadness (Tristeza)
   - Surprise (Sorpresa)

7. FORMATO DE ENTRADA
   ------------------
   - La aplicaciÃ³n acepta texto plano en formato .txt o entrada manual.
   - No hay restricciones de formato especÃ­fico, pero se recomienda texto limpio
     sin caracteres especiales problemÃ¡ticos.

8. NAVEGADOR
   ----------
   - La aplicaciÃ³n Streamlit funciona mejor en navegadores modernos
     (Chrome, Firefox, Safari, Edge).

9. PUERTO Y ACCESO
   ----------------
   - Por defecto, Streamlit usa el puerto 8501. Si estÃ¡ ocupado, Streamlit
     intentarÃ¡ usar el siguiente puerto disponible (8502, 8503, etc.).

================================================================================
                              FIN DEL DOCUMENTO
================================================================================